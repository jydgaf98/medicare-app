<!DOCTYPE html>
<html lang="en">
<head>
    <title>MediCare - Login & Sign Up</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="background-animation"></div>
    <div class="logo">MediCare</div>

    <!-- Authentication Container -->
    <div class="container" id="authContainer">
        <h2 id="formTitle">Login</h2>

        <div id="signupFields" class="hidden">
            <div class="name-container">
                <input type="text" id="firstName" class="input-field" placeholder="First Name" required>
                <input type="text" id="lastName" class="input-field" placeholder="Last Name" required>
            </div>
        </div>

        <input type="email" id="email" class="input-field" placeholder="Email" required>

       <!-- Password Input -->
    <div class="password-container">
        <input type="password" id="password" class="input-field" placeholder="Password" required>
        <i class="fa-solid fa-eye toggle-password" onclick="togglePassword('password', this)"></i>
    </div>

    <!-- Confirm Password Input -->
    <div class="password-container hidden" id="confirmPasswordContainer">
        <input type="password" id="confirmPassword" class="input-field" placeholder="Confirm Password" required>
        <i class="fa-solid fa-eye toggle-password" onclick="togglePassword('confirmPassword', this)"></i>
    </div>

    <!-- Add Font Awesome for Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>


        
        <button type="button" id="authButton">Submit</button>
        <p id="message"></p>
        <p>
            <span>Don't have an account?</span>
            <a href="#" id="toggleText">Sign Up</a>
        </p>
    </div>

    <!-- Medication Form -->
    <div class="container hidden" id="medicationContainer">
        <h2>Medication Details</h2>
        <select id="medType" class="input-field">
            <option value="" disabled selected>Select Medication</option>
            <option value="Biogesic">Biogesic</option>
            <option value="Neozep">Neozep</option>
            <option value="Amoxicillin">Amoxicillin</option>
            <option value="Bioflu">Bioflu</option>
        </select>
        <input type="time" id="medTime" class="input-field" required>
        <button type="button" id="saveMedicationButton">Save</button>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // ✅ Replace with your actual Firebase credentials
        const firebaseConfig = {
            apiKey: "AIzaSyCRfKNIXrZFhksR5jL_o4EBIVLxaf_Hqog",
            authDomain: "medicare-d14d2.firebaseapp.com",
            projectId: "medicare-d14d2",
            storageBucket: "medicare-d14d2.appspot.com",
            messagingSenderId: "279260936101",
            appId: "1:279260936101:web:164351511af90ec27454ac"
        };

        // ✅ Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // ✅ Toggle Login/Signup Form
        function toggleForm() {
            document.getElementById("signupFields").classList.toggle("hidden");
            document.getElementById("confirmPasswordContainer").classList.toggle("hidden");
            document.getElementById("formTitle").innerText = document.getElementById("signupFields").classList.contains("hidden") ? "Login" : "Sign Up";
        }
        document.getElementById("toggleText").addEventListener("click", toggleForm);

        // ✅ Authentication Logic
        document.getElementById("authButton").addEventListener("click", async () => {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirmPassword").value;
            const message = document.getElementById("message");
            const isSignUp = !document.getElementById("signupFields").classList.contains("hidden");

            try {
                if (isSignUp) {
                    if (password !== confirmPassword) {
                        message.innerText = "Passwords do not match!";
                        return;
                    }
                    await createUserWithEmailAndPassword(auth, email, password);
                    message.innerText = "Sign up successful! You can now log in.";
                } else {
                    await signInWithEmailAndPassword(auth, email, password);
                    message.innerText = "Login successful!";
                    document.getElementById("authContainer").classList.add("hidden");
                    document.getElementById("medicationContainer").classList.remove("hidden");
                }
            } catch (error) {
                message.innerText = error.message;
            }
        });

        // ✅ Firestore Medication Saving
        document.getElementById("saveMedicationButton").addEventListener("click", async () => {
            const medType = document.getElementById("medType").value;
            const medTime = document.getElementById("medTime").value;
            if (!medType || !medTime) {
                alert("Please select medication and time!");
                return;
            }
            try {
                await addDoc(collection(db, "medications"), {
                    medication: medType,
                    time: medTime,
                    timestamp: new Date()
                });
                alert("Medication saved successfully!");
            } catch (error) {
                alert("Error saving medication: " + error.message);
            }
        });
    </script>

    <script type="module" src="script.js"></script>
</body>
</html>
